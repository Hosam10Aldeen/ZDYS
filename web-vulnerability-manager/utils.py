# utils.py

def normalize_output(output):
    if isinstance(output, list):
        output = '\n'.join(output)  # convert list to a string
    return output.replace('\n', '<br>')

def calculate_cvss(output):
    if 'critical' in output.lower():
        return 9.8
    elif 'high' in output.lower():
        return 7.5
    elif 'medium' in output.lower():
        return 5.0
    elif 'low' in output.lower():
        return 2.5
    else:
        return 0.0
