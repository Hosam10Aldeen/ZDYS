# kali_api_server.py (Kali üzerinde çalışır)
from flask import Flask, request, jsonify
import subprocess

app = Flask(__name__)

@app.route('/scan/nmap', methods=['POST'])
def nmap_scan():
    target = request.json.get('target')
    result = subprocess.getoutput(f"nmap -sV {target}")
    return jsonify({"tool": "nmap", "output": result})

@app.route('/scan/nikto', methods=['POST'])
def nikto_scan():
    target = request.json.get('target')
    result = subprocess.getoutput(f"nikto -h {target}")
    return jsonify({"tool": "nikto", "output": result})

@app.route('/scan/wpscan', methods=['POST'])
def wpscan_scan():
    target = request.json.get('target')
    result = subprocess.getoutput(f"wpscan --url {target}")
    return jsonify({"tool": "wpscan", "output": result})

@app.route('/scan/zap', methods=['POST'])
def zap_scan():
    target = request.json.get('target')
    result = subprocess.getoutput(f"zap-cli quick-scan --self-contained --start-options '-config api.disablekey=true' {target}")
    return jsonify({"tool": "zap", "output": result})

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
