# scanner_api_client.py
import requests

KALI_API = "http://192.168.1.119:5000"

def run_scan(tool, target):
    endpoint = f"{KALI_API}/scan/{tool}"
    try:
        resp = requests.post(endpoint, json={"target": target}, timeout=650)
        resp.raise_for_status()
        data = resp.json()
    except requests.exceptions.Timeout:
        return {"tool": tool, "error": "Scan request timed out."}
    except requests.exceptions.RequestException as e:
        return {"tool": tool, "error": f"Request failed: {e}"}
    if isinstance(data, dict) and data.get("error"):
        return {"tool": tool, "error": data.get("error")}
    return data
